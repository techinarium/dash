{"version":3,"file":"dashboard-35a885773faf4de06d3b.js","sources":["webpack:///webpack/bootstrap ecd7ef7073ee654955a4","webpack:///app/javascript/widget-api/api/v0/element.js","webpack:///app/javascript/widget-api/api/v0/events.js","webpack:///app/javascript/packs/dashboard.js","webpack:///app/javascript/widget-api/index.js","webpack:///app/javascript/widget-api/api/v0/index.js","webpack:///app/javascript/widget-api/api/v0/data.js","webpack:///app/javascript/widget-api/api/v0/layout.js","webpack:///app/javascript/widget-api/api/v0/render.private.js","webpack:///app/javascript/widget-layout/index.js","webpack:///app/javascript/widget-layout/dash-math.js"],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/packs/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ecd7ef7073ee654955a4","export default function(state) {\n  function _applyStyles(el, styles) {\n    for (const prop in styles) {\n      const name = prop.replace(/([a-z\\d])([A-Z])/, '$1-$2').toLowerCase()\n\n      // console.log('style: ', name, styles[prop])\n\n      el.style[name] = styles[prop]\n    }\n  }\n\n  function _attachHandler(el, name, handler) {\n    // Handle properties starting with 'on'\n\n    const eventName = name.slice(2).toLowerCase()\n\n    // console.log(eventName)\n\n    el.addEventListener(eventName, handler)\n  }\n  \n  function _attachChildren(el, children = []) {\n    children.forEach(child => {\n      if (typeof child === 'string') {\n        child = text(child)\n      }\n      \n      try {\n        el.appendChild(child)\n      } catch (err) {\n        console.warn('failed to attach child', child, 'to parent', el, err)\n      }\n    })\n  }\n\n  function _applyAttribute(el, name, value) {\n    switch(name.toLowerCase()) {\n    default:\n      el.setAttribute(name, value)\n      break\n    }\n  }\n\n  function _applyProps(el, props) {\n    for (const key in props) {\n      const k = key.toLowerCase()\n\n      if (/^on/.test(k)) {\n        // Is an event handler\n        _attachHandler(el, key, props[key])\n      } else if (k === 'styles') {\n        _applyStyles(el, props[key])\n      } else {\n        // Treat as a regular attribute.\n        _applyAttribute(el, key, props[key])\n      }\n    }\n  }\n\n  function _el(tag, props, children) {\n    // console.log('creating element', tag, props, children)\n    \n    // Create DOM nodes.\n    const el = document.createElement(tag)\n    if (props) {\n      if (Array.isArray(props) && !children) {\n        // Assume children was passed as the second prop.\n        children = props\n        props = null\n      } else if (typeof props === 'object') {\n        _applyProps(el, props)\n      }\n    }\n    if (children && !Array.isArray(children)) {\n      children = [children]\n    }\n    _attachChildren(el, children)\n    return el\n  }\n\n  function textbox(props, value) {\n    const el = _el('textarea', props)\n\n    _applyStyles(el, {\n      position: 'relative',\n      border: 0,\n      resize: 'none',\n    })\n    \n    if (typeof value === 'string') {\n      el.value = value\n    }\n\n    return el\n  }\n\n  function text(value) {\n    // console.log('Instantiating a text element')\n\n    return document.createTextNode(value)\n  }\n\n  return {\n    text,\n    textbox,\n    RAW: _el\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// app/javascript/widget-api/api/v0/element.js","export default function events() {\n  const listeners = {}\n\n  return {\n    on(event, func) {\n      if (!listeners[event]) {\n        listeners[event] = []\n      }\n\n      listeners[event].push(func)\n    },\n    once(event, func) {\n      if (!listeners[event]) {\n        listeners[event] = []\n      }\n      \n      const selfDestruct = function(...args) {\n        func(...args)\n        listeners[event] = listeners[event].filter(f => f !== selfDestruct)\n        console.log('once listener self destructed')\n      }\n      \n      listeners[event].push(selfDestruct)\n    },\n    emit(event, ...data) {\n      if (listeners[event]) {\n        listeners[event].forEach(func => func(...data))\n      }\n    }\n  }\n}\n\n\n// WEBPACK FOOTER //\n// app/javascript/widget-api/api/v0/events.js","/* eslint no-console:0 */\n// This file is automatically compiled by Webpack, along with any other files\n// present in this directory. You're encouraged to place your actual application logic in\n// a relevant structure within app/javascript and only use these pack files to reference\n// that code so it'll be compiled.\n//\n// To reference this file, add <%= javascript_pack_tag 'application' %> to the appropriate\n// layout file, like app/views/layouts/application.html.erb\n\nimport API from '../widget-api'\nimport Layout from '../widget-layout'\n\n$(document).on('turbolinks:load', () => {\n  const { on } = API.private\n  const Dash = API.public\n  let widgets = []\n\n  const layout = Layout()\n\n  // on('widgetCreated', widget => {\n//     console.log('widget', widget)\n//     Layout.add(widget)\n//   })\n\n  function loadAllWidgetInstances() {\n    // Get all widget instances for the current user and load\n    // whatever is needed to get them up and running in the dashboard.\n    $.get('/widget_instances.json').done(instances => {\n      instances.forEach(instance => {\n        loadWidgetInstance(instance)\n      })\n    }).fail(err => {\n      console.error(err)\n    })\n  }\n\n  function loadWidgetInstance(instance) {\n    $.get(`/widgets/${instance.widget_id}.json`).done(value => {\n      const latestCode = value.codes\n        .sort((a, b) => a.updated_at > b.updated_at ? 1 : -1)[0]\n\n      if (latestCode) {\n        const widget = eval(latestCode.widget_code)\n        widget.state.instanceID = instance.id\n        widget.state.widgetID = instance.widget_id\n        widget.state.data = instance.data\n\n        widget.coords = {\n          x: instance.coord_x,\n          y: instance.coord_y\n        }\n\n        if (instance.size_x && instance.size_y) {\n          widget.state.size = instance.size_x + 'x' + instance.size_y\n        }\n\n        widgets.push(widget)\n        layout.add(widget)\n\n        widget.on('destroyRequested', loadedInstance => {\n          console.log(`widget instance ${loadedInstance} requested self destruct`)\n          widget.state.root.parentNode.removeChild(widget.state.root)\n          widgets = widgets.filter(w => w !== widget)\n          destroyWidgetInstance(loadedInstance)\n        })\n\n        widget.on('dataChanged', state => {\n          console.log('data changed', state)\n        })\n\n        widget.on('sizeChanged', state => {\n          layout.updateSize(widget)\n        })\n\n        widget.on('stateChanged', state => {\n          const [size_x, size_y] = state.size.split('x').map(n => parseInt(n))\n          const { x, y } = state.coords\n          const sendable = {\n            data: state.data,\n            size_x,\n            size_y,\n            coord_x: x,\n            coord_y: y,\n          }\n\n          $.ajax(`/widget_instances/${instance.id}.json`, {\n            method: 'PATCH',\n            data: {\n              widget_instance: sendable\n            }\n          }).done(response => {\n            console.log('saved instance data', response)\n          }).fail(err => {\n            console.error(err)\n          })\n        })\n\n      } else {\n        alert('No loadable version of the widget code')\n      }\n    }).fail(err => {\n      console.error(err)\n      alert(err)\n    })\n  }\n  \n  function createWidgetInstance(id) {\n    $.post(`/widget_instances.json`, {\n      widget_instance: {\n        widget_id: id,\n        data: {}\n      }\n    }).done(result => {\n      loadWidgetInstance(result)\n    }).fail(err => {\n      console.error(err)\n    })\n  }\n  \n  function destroyWidgetInstance(instanceID) {\n    $.ajax({\n      url: `/widget_instances/${instanceID}.json`,\n      method: 'DELETE'\n    }).done(() => {\n      console.log('Removed widget instance', instanceID)\n    }).fail(err => {\n      console.error('Failed to remove widget instance', instanceID, error)\n    })\n  }\n\n  window.DashControl = {\n    createWidgetInstance,\n    destroyWidgetInstance,\n    loadAllWidgetInstances,\n  }\n  window.Dash = Dash\n  console.log('Dash widget API loaded')\n  \n  // Try to load all widget instances\n  // to populate the dashboard.\n  loadAllWidgetInstances()\n})\n\n\n\n// WEBPACK FOOTER //\n// app/javascript/packs/dashboard.js","import v0 from './api/v0/index.js'\nimport _events from './api/v0/events.js'\n\nconst APIs = {\n  'v0': v0,\n}\n\n/*\n\nWe want to:\n- Load a widget and its code from the database\n- Execute the widget's code, which sets up the widget\n- Hook the widget setup and restore any saved state\n- Create a grid element for the widget\n- run the widget's setLayout function, which\n  calls render() on whichever layout is being set.\n- Take the result of render() and attach to the grid element\n*/\n\n// The public Dash.* API globally available to Dash developers.\nexport default (function() {\n\n  const events = _events()\n\n  function widget(apiVersion, setupFunction) {\n    let version\n\n    // Make sure apiVersion is a string and the version exists.\n\n    if (typeof apiVersion !== 'string' || apiVersion.toLowerCase()[0] !== 'v') {\n      throw new Error('First parameter should be the Widget API version in the vX format: v0, v1, v2, etc.')\n    }\n\n    version = apiVersion.toLowerCase();\n\n    if (!APIs[version]) {\n      throw new Error(`API version ${apiVersion} does not exist. Available: ${Object.keys(APIs).join(', ')}`)\n    }\n\n    // Make sure the setupFunction is a function.\n\n    if (typeof setupFunction !== 'function') {\n      throw new Error('Second parameter should be a function that sets up the widget: function(widget) { ... }')\n    }\n\n    // The API is called as a function to create a brand new copy for each widget.\n    // Each widget will have an ID from the database - for now using 123\n    const api = new (APIs[version])()\n\n    // TODO: Make the private portion available to the behind-the-scenes dashboard code\n\n    // Send off the public portion to the caller.\n    setupFunction.call(null, api.public)\n\n    events.emit('widgetCreated', api.private)\n    \n    return api.private\n  }\n\n  return {\n    private: {\n      on(event, func) {\n        events.on(event, func)\n      }\n    },\n    public: { widget }\n  }\n})()\n\n\n\n// WEBPACK FOOTER //\n// app/javascript/widget-api/index.js","import _data from './data.js'\nimport _element from './element.js'\nimport _layout from './layout.js'\nimport _events from './events.js'\nimport _render from './render.private.js'\n\nexport default function() {\n  // Mutable state object shared by the API functions\n  const state = {\n    container: null,\n    dom: null, // Root node resulting from layout.render()\n    root: null, // Container that 'dom' gets attached to\n    isRendered: false,\n    size: null,\n    data: {},\n    layouts: []\n  }\n\n  const events = _events(state)\n  const render = _render(state, events)\n  const data = _data(state, events)\n  const element = _element(state, events)\n\n  const { layout, setLayout } = _layout(state, events)\n\n  events.on('setLayout', () => {\n    render()\n    events.emit('stateChanged', state)\n  })\n\n  events.on('sizeChanged', () => {\n    events.emit('stateChanged', state)\n  })\n\n  events.on('coordsChanged', () => {\n    events.emit('stateChanged', state)\n  })\n\n  return {\n    private: {\n      // This is where the internal lifecycle triggers and things might go\n      // Stuff that's used by Dash behind the scenes\n      get state() {\n        return state\n      },\n      sizes() {\n        return state.layouts.map(l => l.size)\n      },\n      on(event, func) {\n        events.on(event, func)\n      },\n      once(event, func) {\n        events.once(event, func)\n      },\n      init(container) {\n        if (!state.data || Object.keys(state.data).length === 0) data._load()\n        state.size = state.size || (state.layouts.find(l => l.default) || state.layouts[0]).size\n\n        state.container = container\n        state.root = container.querySelector('.widget-root')\n\n        render()\n      },\n      set coords(val) {\n        state.coords = {\n          x: val.x,\n          y: val.y\n        }\n        events.emit('coordsChanged', state)\n      },\n      get coords() {\n        return state.coords\n      },\n      render,\n    },\n    public: {\n      get dom() {\n        return state.dom\n      },\n      get size() {\n        return state.size\n      },\n      set size(value) {\n        const isValid = ['1x1', '1x2', '2x1', '2x2'].includes(value.toLowerCase())\n        const hasLayout = state.layouts.map(s => s.size).includes(value)\n\n        if (isValid && hasLayout) {\n          state.size = value\n          events.emit('sizeChanged', state)\n          render()\n        } else {\n          if (!isValid) {\n            throw new Error(`Can't set size to ${value}: must be one of these strings: '1x1', '1x2', '2x1', '2x2'`)\n          }\n\n          if (!hasLayout) {\n            throw new Error(`Can't set size to ${value}: No layouts defined for that size.`)\n          }\n        }\n      },\n      data: {\n        get: data.get,\n        set: data.set,\n      },\n      element,\n      layout,\n      setLayout,\n    },\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// app/javascript/widget-api/api/v0/index.js","export default function(state, events) {\n\n  if (!state.data) state.data = {}\n\n  function _save() {\n    localStorage.setItem(`widget_instance_${state.instanceID}_data`, JSON.stringify(state.data))\n    \n    // console.log('saved', state.data)\n  }\n\n  function _load() {\n    state.data = JSON.parse(localStorage.getItem(`widget_instance_${state.instanceID}_data`) || '{}')\n    \n    // console.log('loaded', state.data)\n  }\n\n  function get(property) {\n    if (Array.isArray(property)) {\n      // Take an array, return an array.\n      return property.map(p => state.data[p])\n    } else if (typeof property === 'string') {\n      // Take a string, return a value.\n      return state.data[property]\n    } else {\n      throw new Error('data.get() takes either an array or a string as the first parameter. Received ' + (typeof parameter))\n    }\n  }\n\n  function set(property, value) {\n    // Takes a name and a value, or an object of names and values to update.\n\n    if (typeof property === 'object') {\n      if (typeof value !== 'undefined') {\n        throw new Error('data.set() takes either a string and a value, or an object. Received an object as the first parameter and a ' + (typeof value) + ' as the second.')\n      }\n      let props = property\n\n      // Update by object.\n      for (const key in props) {\n        state.data[key] = props[key]\n      }\n\n    } else if (typeof property === 'string') {\n      // Update by value.\n      state.data[property] = value\n\n    } else {\n      throw new Error('data.set() takes either a string or an object as the first parameter. Received ' + (typeof parameter))\n    }\n\n    events.emit('dataChanged', state)\n    _save() // Save after every set.\n  }\n\n  return { get, set, _save, _load }\n}\n\n\n\n// WEBPACK FOOTER //\n// app/javascript/widget-api/api/v0/data.js","export default function(state, events) {\n\n  if (!state.layouts) state.layouts = []\n\n  function layout(conf) {\n    // Validate\n    if (typeof conf === 'object' && !Array.isArray(conf)) {\n      // It's the right type of thing. Make sure it has the right properties.\n\n      if (typeof conf.name !== 'string') {\n        // name must exist and be a string\n      }\n\n      if (typeof conf.size !== 'string' && !Array.isArray(conf.size)) {\n        // size must be a string or array\n      }\n\n      if (typeof conf.render !== 'function') {\n        // must have a render function\n      }\n\n      state.layouts.push(conf) // Everything checks out\n\n    } else {\n      if (!conf) {\n        throw new Error('api.layout() was called without any layout object.')\n      } else {\n        throw new Error('api.layout() takes a layout object as the first parameter. Received ' + (typeof conf))\n      }\n    }\n  }\n\n  function setLayout(name, transition) {\n    console.log('Setting layout to ' + name)\n\n    state.layoutName = name;\n    events.emit('setLayout', name)\n    // Render the layout for the current size, save it as state.dom and append it to state.root\n  }\n\n  return { layout, setLayout }\n}\n\n\n\n// WEBPACK FOOTER //\n// app/javascript/widget-api/api/v0/layout.js","import _element from './element.js'\n\nexport default function(state, events) {\n  return function(root) {\n    if (state.isRendered) {\n      return false\n    }\n\n    const { RAW } = _element(state)\n\n    root = root || state.root\n    state.root = root\n\n    const layouts = state.layouts\n      .filter(l => l.size === state.size)\n\n    if (state.dom) {\n      state.dom.parentNode.removeChild(state.dom)\n    }\n\n    if (state.layoutName) {\n      const layout = layouts.find(l => l.name === state.layoutName)\n\n      if (layout) {\n        state.dom = layout.render()\n      } else {\n        state.dom = layouts[0].render()\n      }\n    } else if (layouts[0] || state.layouts[0]) {\n      state.dom = layouts[0].render()\n    }\n  \n    const toolbar = RAW('div', { class: 'widget-toolbar' }, [\n      RAW('a', {\n        href: '#',\n        class: 'widget-toolbar-button',\n        onClick: e => {\n          e.preventDefault()\n          events.emit('destroyRequested', state.instanceID)\n        }\n      }, [\n        RAW('img', { src: '/widget-x-icon.png' })\n      ])\n    ])\n    \n    root.appendChild(toolbar)\n\n    // root.appendChild(toolbar)\n    root.appendChild(state.dom)\n\n    state.isRendered = true\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// app/javascript/widget-api/api/v0/render.private.js","// Manages the layout of the dashboard\n\nimport DashMath from './dash-math.js'\n\nlet dragCoordOffset\n\nfunction coordsInPixels({ x, y }, dashMath) {\n  return {\n    x: x * dashMath.unitSize,\n    y: y * dashMath.unitSize\n  }\n}\n\nfunction showGridGuide($guide = $('.dashboard-grid-square')) {\n  if ($guide) {\n    $guide.removeClass('hidden')\n  }\n}\n\nfunction hideGridGuide($guide = $('.dashboard-grid-square')) {\n  if ($guide) {\n    $guide.addClass('hidden')\n  }\n}\n\nfunction moveGridGuideTo({ x, y }, $guide = $('.dashboard-grid-square')) {\n  if ($guide) {\n    $guide.css({ transform: `translate(${x}px, ${y}px)`})\n  }\n}\n\nfunction setGridGuideSize(w, h, $guide = $('.dashboard-grid-square')) {\n  if ($guide) {\n    $guide.css({ width: w + 'px', height: h + 'px' })\n  }\n}\n\nfunction getDragCoords(e, $root, widget, unitSize, dragCoordOffset) {\n  let x, y\n  const { container } = widget.state\n  const gridBounds = $root[0].getBoundingClientRect()\n\n  x = e.clientX - gridBounds.left// - dragStartOffset.x\n  y = e.clientY - gridBounds.top// - dragStartOffset.y\n\n  x /= unitSize\n  y /= unitSize\n\n  // Throw away fractional component\n  x = ~~x\n  y = ~~y\n\n  // Adjust for coord offset\n  x -= dragCoordOffset.x\n  y -= dragCoordOffset.y\n\n  return { x, y }\n}\n\nfunction setUpEvents($el, $root, widget, dm, update, widgets) {\n  let dragImage\n  const $gridGuide = $('.dashboard-grid-square')\n\n  $el.on('dragstart', function(e) {\n    dragImage = dragImage || document.querySelector('#placeholder-pixel')\n    e.originalEvent.dataTransfer.setDragImage(dragImage, 0, 0)\n    $(this).addClass('dragging')\n\n    const unitSize = dm.unitSize\n    const [width, height] = widget.state.size\n      .split('x')\n      .map(n => parseInt(n) * unitSize)\n\n    setGridGuideSize(width, height, $gridGuide)\n    showGridGuide($gridGuide)\n\n    dragCoordOffset = {\n      x: ~~(e.offsetX / unitSize),\n      y: ~~(e.offsetY / unitSize)\n    }\n  })\n\n  $el.on('dragend', function(e) {\n    e.originalEvent.preventDefault()\n    $(this).removeClass('dragging')\n\n    hideGridGuide($gridGuide)\n\n    widget.coords = getDragCoords(e, $root, widget, dm.unitSize, dragCoordOffset)\n\n    update()\n  })\n\n  let lastFire = 0\n  let last = { x: null, y: null }\n  $root.on('dragover', function(e) {\n    const now = Date.now()\n    // Debounce. Otherwise this event fires ridiculously often.\n    if (now - lastFire > 60) {\n      const coords = getDragCoords(e, $root, widget, dm.unitSize, dragCoordOffset)\n      const coordsAreDifferent = !(coords.x === last.x && coords.y === last.y)\n\n      if (coordsAreDifferent) {\n        moveGridGuideTo(coordsInPixels(coords, dm), $gridGuide)\n        last = coords\n      }\n\n      lastFire = now\n    }\n  })\n}\n\nexport default function() {\n  const widgets = []\n  const $root = $('#dashboard-widgets')\n  const $guide = $(`\n    <div class=\"dashboard-grid-square\">\n      <div class=\"dashboard-grid-fill\"></div>\n    </div>`)\n  $root.append($guide)\n  const dm = DashMath($root)\n\n  function updateWidget(widget) {\n    const { x, y } = coordsInPixels(widget.coords || { x: 0, y: 0 }, dm)\n\n    updateSize(widget)\n    widget.state.container.style.transform = `translate(${x}px, ${y}px)`\n    widget.render()\n  }\n\n  function update() {\n    widgets.forEach(updateWidget)\n  }\n\n  function add(widget) {\n    const $el = $('<div class=\"widget-container\"><div class=\"widget-root\"></div></div>')\n    $el.data('instance-id', widget.state.instanceID)\n    $el.prop('draggable', true)\n    $root.append($el)\n\n    widgets.push(widget)\n\n    // console.log(`${widgets.length} widget${widgets.length === 1 ? ' is' : 's are'} loaded`)\n\n    setUpEvents($el, $root, widget, dm, update, widgets)\n    widget.init($el[0])\n    updateWidget(widget)\n  }\n\n  function updateSize(widget) {\n    const { container } = widget.state\n    const unitSize = dm.unitSize\n    const [w, h] = widget.state.size\n      .split('x')\n      .map(n => parseInt(n) * unitSize)\n\n    container.width = w\n    container.height = h\n    container.style.width = w + 'px'\n    container.style.height = h + 'px'\n  }\n\n  window.addEventListener('resize', () => {\n    update()\n  })\n\n  return {\n    add,\n    updateSize,\n    update\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// app/javascript/widget-layout/index.js","export default function($root, $grid) {\n  let props = {}\n\n  window.addEventListener('resize', () => {\n    console.log('resized')\n    recalculate()\n  })\n\n  function recalculate() {\n    const width = $root.parent().width()\n    let columns\n    let unitSize\n\n    if (width > 1200) {\n      columns = 12\n      unitSize = 100\n    } else if (width > 800) {\n      columns = 8\n      unitSize = 100\n    } else if (width > 600) {\n      columns = 6\n      unitSize = 100\n    } else if (width > 400) {\n      columns = 4\n      unitSize = 100\n    } else {\n      columns = 2\n      unitSize = width / columns\n    }\n\n    props.unitSize = unitSize\n    props.columns = columns\n\n    console.log('recalculated', props)\n  }\n\n  function showGrid() {\n    $grid.find('.dashboard-grid-square')\n      .width(props.unitSize)\n      .height(props.unitSize)\n    $grid.show()\n  }\n\n  function hideGrid() {\n    $grid.hide()\n  }\n\n  function getUnitSize() {\n    return props.unitSize || 100\n  }\n\n  recalculate()\n\n  return {\n    get unitSize() {\n      return getUnitSize()\n    },\n    recalculate,\n    showGrid,\n    hideGrid\n  }\n}\n\n\n// WEBPACK FOOTER //\n// app/javascript/widget-layout/dash-math.js"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;;;;;;;;;;;;;;;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAzBA;AA2BA;;;;;;;;;;;;;;;;;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AALA;AACA;AAOA;AACA;AACA;AACA;AADA;AAFA;AAMA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AADA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC7IA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;;;;;;;;;AAWA;AAhBA;AACA;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AANA;AAQA;;;;;;;;;;;;ACnEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AACA;AASA;AACA;AACA;AACA;AACA;AAhBA;AAAA;AAAA;AACA;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AAlCA;AAoCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AA/BA;AArCA;AAuEA;;;;;;;;;;;;;;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACzCA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAAA;AACA;AAMA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AANA;AACA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AADA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AAAA;AARA;AAAA;AAAA;AACA;AASA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAHA;AAKA;AAAA;AALA;AAAA;AAAA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;;;;;;;;;;;;AC3KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;;;A","sourceRoot":""}